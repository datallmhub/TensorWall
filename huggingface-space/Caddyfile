# Caddy reverse proxy for HF Space
# Routes /api/* to backend, everything else to frontend

:7860 {
    # API routes -> Backend (FastAPI)
    handle /api/* {
        reverse_proxy localhost:8000
    }

    handle /v1/* {
        reverse_proxy localhost:8000
    }

    handle /auth/* {
        reverse_proxy localhost:8000
    }

    handle /admin/* {
        reverse_proxy localhost:8000
    }

    handle /health/* {
        reverse_proxy localhost:8000
    }

    handle /docs* {
        reverse_proxy localhost:8000
    }

    handle /redoc* {
        reverse_proxy localhost:8000
    }

    handle /openapi.json {
        reverse_proxy localhost:8000
    }

    # Everything else -> Frontend (Next.js)
    handle {
        reverse_proxy localhost:3000
    }

    log {
        output stdout
        format console
    }
}
